# メモ

##  小言

[離れた場所での同時消し＋同時消し数表示＋コンボ](https://youtu.be/ObY7zUBq4A8?t=54)

**[ハードお邪魔セルの挙動](https://youtu.be/DYZe5CJtvfU?t=1887)**  

OK? → 書いたけど、未検証

<br><br>

# スクロールと、セルの状態更新をどっちが先か、

- スクロールが先なら
  - スクロールしたタイミングで、１番下のセルで繋がるので、１フレーム早く繋がる
- 更新が先なら
  - スクロール待機時間はセルの状態依存なので、
    - セルの状態更新後すぐにスクロール待機時間を減らせるので  
      １フレーム早くスクロールし始めれる

**[パネポンは多分スクロールが先](https://youtu.be/DYZe5CJtvfU?t=1341)**

<br><br>

# ゲームオーバー条件
- スクロール待機時間が０のときに、ゲームエリア内の一番上の列にセルがある

<br><br>

# ゲームルール制作中
1. 操作
2. スクロール
3. セルの状態更新（移動/変化）(左下から、右に、上に向かって)
4. お邪魔セルの落下
- ゲームオーバー    未実装

- 操作
  - カーソル移動            *OK?*
  - セルの入れ替え          *OK?*
  - クリックでの入れ替え    *例外*
  - スクロール速度上昇      *未実装*

- スクロール
  - スクロールするかどうか    *OK*
  - ゲームオーバーかどうか    *OK?*
  - セルを一つ上の段に上げる  *OK*
  - 新しいセルをRow:-1に追加  *OK*

- [セルの状態を更新する](#セルの状態を更新する)
  - セルの移動（落下）      *OK?*
  - 消滅                    *OK?*
  - お邪魔セル変換          *未実装*
  - スクロール待機時間変更  *未実装*
  - コンボ                  *未実装*
  - 送りつけるお邪魔ぷよ    *未実装*

- お邪魔セルの落下          *未実装*
  - お邪魔セルが落下する条件
  - お邪魔セルを落下させる
  - めんどそう

- その他メモ
  - そもそもゲームループがまだ無い

<br><br>

# セルの状態

* CellState
  * Free
  * Lock
  * Flash
  * Neutral
  * Moment
* CellType
  * ノーマル
  * お邪魔
* Timer
  * Flash
  * Neutral
  * Lock



### 表示側で必要な、セルの状態
* Free              普通に表示する
* Flash             点滅させる
* Neutral           顔になる
* Moment            消滅変身アニメーション

<br>

### ロジック側で必要な、セルの状態
* Free              入れ替えれる。落下出来る
* Lock              操作不能

<br>

### セルが自分を制御するために必要な情報

  Timer               そのタイマーが０かつ、次のタイマーが１以上
* Flash               状態をNeutralにする
* Neutral             状態をMomentにする
* Moment              状態をLockにする
* Lock
  * セルの種類は通常    状態をFreeにする  
                        種類をEmptyにする
  * セルの種類はお邪魔  種類をランダムなノーマルにする

<br>

### メモ

- （消滅でなく）落下し始めるたセルは、その次のフレームから前にあった位置にセルを移動させれる

<br><br>

# セルのビュー

* 移動
* 点滅
* 待機（顔）
* 消滅
  * ノーマル
    * 顔→空
  * お邪魔
    * 顔→ノーマル
